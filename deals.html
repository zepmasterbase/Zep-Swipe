<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Zep Swipe — Campus Market</title>

<style>
  :root{
    --zep-blue:#00f0ff;
    --zep-violet:#9c4dff;
    --bg:radial-gradient(circle at 25% 10%, #050018 0%, #00000c 100%);
    --glass:rgba(255,255,255,0.08);
  }

  body{
    margin:0;
    font-family:Poppins,sans-serif;
    background: var(--bg);
    color:#fff;
    min-height:100vh;
    padding:20px;
  }

  h1{
    font-family:Orbitron;
    font-size:1.6rem;
    background: linear-gradient(90deg, var(--zep-blue), var(--zep-violet));
    -webkit-background-clip:text;
    -webkit-text-fill-color:transparent;
    text-align:center;
    margin-bottom:24px;
  }

  .store-card{
    background: var(--glass);
    border:1px solid rgba(255,255,255,.12);
    border-radius:18px;
    padding:16px;
    margin-bottom:16px;
    box-shadow:0 0 28px rgba(0,240,255,.25);
  }

  .store-logo{
    width:100%;
    max-height:150px;
    object-fit:contain;
    border-radius:12px;
    margin-bottom:12px;
  }

  .store-name{
    font-family:Orbitron;
    font-size:1.2rem;
    margin-bottom:6px;
  }

  .store-info{
    font-size:13px;
    opacity:.85;
    margin-bottom:6px;
  }

  .distance{
    font-weight:700;
    color: var(--zep-blue);
  }

  .view-btn{
    display:inline-block;
    margin-top:10px;
    padding:10px 20px;
    border-radius:999px;
    font-family:Orbitron;
    font-weight:700;
    text-decoration:none;
    background:linear-gradient(90deg, var(--zep-blue), var(--zep-violet));
    color:#050015;
    box-shadow:0 0 20px rgba(0,240,255,.35);
    transition:.25s;
  }

  .view-btn:hover{
    transform:translateY(-2px);
    box-shadow:0 0 36px rgba(156,77,255,.45);
  }

  @media(max-width:480px){
    h1{ font-size:1.3rem; }
    .view-btn{ padding:8px 16px; font-size:12px; }
  }
</style>
</head>

<body>

<h1>Campus Market — Student Deals</h1>

<div id="storesContainer"></div>

<script>
  // ----------------------------
  // Define store data
  // ----------------------------
  const stores = [
    {
      name: "Campus Cafe",
      logo: "https://via.placeholder.com/300x150.png?text=Campus+Cafe",
      address: "123 Campus Road, Cape Town",
      lat: -33.9571,
      lng: 18.4603,
      hours: "Mon-Fri 08:00-18:00",
      deals: ["20% off coffee", "Buy 2 get 1 free pastries"]
    },
    {
      name: "BookHub Store",
      logo: "https://via.placeholder.com/300x150.png?text=BookHub",
      address: "45 University Avenue, Durban",
      lat: -29.8587,
      lng: 31.0218,
      hours: "Mon-Fri 09:00-17:00",
      deals: ["10% off textbooks", "Free notebook with purchase"]
    }
    // Add more stores here by following the same object structure
  ];

  const container = document.getElementById("storesContainer");

  function getDistanceFromLatLonInKm(lat1, lon1, lat2, lon2){
    const R = 6371; // km
    const dLat = (lat2-lat1)*Math.PI/180;
    const dLon = (lon2-lon1)*Math.PI/180;
    const a = Math.sin(dLat/2)*Math.sin(dLat/2)+
              Math.cos(lat1*Math.PI/180)*Math.cos(lat2*Math.PI/180)*
              Math.sin(dLon/2)*Math.sin(dLon/2);
    const c = 2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a));
    return R*c;
  }

  // Get user location
  function displayStores(position){
    const userLat = position.coords.latitude;
    const userLon = position.coords.longitude;

    stores.forEach(store=>{
      const distance = getDistanceFromLatLonInKm(userLat,userLon,store.lat,store.lng).toFixed(2);
      
      const div = document.createElement("div");
      div.className = "store-card";

      div.innerHTML = `
        <img src="${store.logo}" alt="${store.name}" class="store-logo">
        <div class="store-name">${store.name}</div>
        <div class="store-info">Address: ${store.address}</div>
        <div class="store-info">Hours: ${store.hours}</div>
        <div class="distance">Distance: ${distance} km</div>
        <a href="#" class="view-btn" onclick='viewStore(${JSON.stringify(store)})'>View Store Details</a>
      `;
      container.appendChild(div);
    });
  }

  function locationError(err){
    stores.forEach(store=>{
      const div = document.createElement("div");
      div.className = "store-card";

      div.innerHTML = `
        <img src="${store.logo}" alt="${store.name}" class="store-logo">
        <div class="store-name">${store.name}</div>
        <div class="store-info">Address: ${store.address}</div>
        <div class="store-info">Hours: ${store.hours}</div>
        <div class="distance">Distance: unavailable</div>
        <a href="#" class="view-btn" onclick='viewStore(${JSON.stringify(store)})'>View Store Details</a>
      `;
      container.appendChild(div);
    });
  }

  if(navigator.geolocation){
    navigator.geolocation.getCurrentPosition(displayStores, locationError);
  } else {
    locationError();
  }

  // Save selected store to localStorage and redirect
  function viewStore(store){
    localStorage.setItem("currentStore", JSON.stringify(store));
    window.location.href = "store.html";
  }
</script>

</body>
</html>