<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Zep Swipe — Student Deals</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600;700&family=Poppins:wght@300;400,500,600&display=swap" rel="stylesheet">
<style>
:root{
  --zep-blue:#00f0ff;
  --zep-violet:#9c4dff;
  --bg:radial-gradient(circle at 30% 10%, #050018, #00000c);
  --glass:rgba(255,255,255,0.08);
  --text-light:rgba(255,255,255,.85);
  --badge-green:#00ff9d;
  --badge-gray:#aaa;
}

/* RESET */
*{box-sizing:border-box;margin:0;padding:0;font-family:Poppins,sans-serif;}
body{background:var(--bg);color:#fff;min-height:100vh;line-height:1.4;}

/* HEADER */
header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:16px 20px;
  max-width:1200px;
  margin:auto;
  border-radius:12px;
  background:rgba(0,0,0,0.15);
  box-shadow:0 0 20px var(--zep-blue),0 0 40px var(--zep-violet);
  animation:pulse 2s infinite;
}
@keyframes pulse{
  0%{box-shadow:0 0 20px var(--zep-blue),0 0 40px var(--zep-violet);}
  50%{box-shadow:0 0 30px var(--zep-blue),0 0 60px var(--zep-violet);}
  100%{box-shadow:0 0 20px var(--zep-blue),0 0 40px var(--zep-violet);}
}
.brand{
  font-family:Orbitron;
  font-size:1.6rem;
  background:linear-gradient(90deg,var(--zep-blue),var(--zep-violet));
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
}
.login-icon{
  width:50px;height:50px;border-radius:50%;
  background:linear-gradient(135deg,var(--zep-blue),var(--zep-violet));
  display:flex;align-items:center;justify-content:center;
  cursor:pointer;font-size:22px;transition:transform .3s,box-shadow .3s;
}
.login-icon:hover{transform:scale(1.1);box-shadow:0 0 12px var(--zep-blue),0 0 25px var(--zep-violet);}

.container{padding:20px;max-width:1200px;margin:auto;}
h2{font-family:Orbitron;margin-bottom:16px;text-align:center;}

.deals-list{display:grid;grid-template-columns:1fr;gap:16px;}
@media(min-width:600px){.deals-list{grid-template-columns:1fr 1fr;}}

.deal-card{
  background:var(--glass);border-radius:16px;padding:16px;border:1px solid rgba(255,255,255,.12);
  display:flex;flex-direction:column;gap:8px;transition:.3s;
}
.deal-card:hover{transform:translateY(-2px);box-shadow:0 0 20px rgba(156,77,255,.3);}

.deal-card h3{font-size:1.1rem;margin-bottom:4px;}
.deal-card p{font-size:.9rem;color:var(--text-light);}
.deal-card .meta{font-size:.8rem;color:var(--text-light);display:flex;justify-content:space-between;align-items:center;margin-top:6px;}
.badge{
  padding:4px 8px;border-radius:999px;font-size:.75rem;font-weight:600;
  text-transform:uppercase;
}
.badge.active{background:var(--badge-green);color:#050015;}
.badge.locked{background:var(--badge-gray);color:#050015;}

.locked-message{
  text-align:center;
  margin:20px 0;
  font-size:0.95rem;
  color:var(--text-light);
}
.locked-message button{
  margin-top:10px;
  padding:10px 16px;
  border:none;
  border-radius:999px;
  background:linear-gradient(90deg,var(--zep-blue),var(--zep-violet));
  color:#050015;
  font-family:Orbitron;
  cursor:pointer;
  transition:.3s;
}
.locked-message button:hover{transform:translateY(-2px);box-shadow:0 0 20px var(--zep-blue),0 0 40px var(--zep-violet);}

.footer-link{
  text-align:center;
  margin:30px 0;
  font-size:.9rem;
}
.footer-link a{
  color:var(--zep-blue);
  text-decoration:none;
  font-weight:600;
}
.footer-link a:hover{text-decoration:underline;}
</style>
</head>
<body>

<header>
  <div class="brand">Zep Swipe</div>
  <div class="login-icon" onclick="location.href='login.html'" title="Login">⎋</div>
</header>

<div class="container">
  <h2>Student Deals Marketplace</h2>
  <div id="dealsContainer" class="deals-list"></div>

  <div class="footer-link">
    Are you a merchant? <a href="merchant-landing.html">List your student deal →</a>
  </div>
</div>

<script>
// Mock current user
const currentUser = JSON.parse(localStorage.getItem("currentUser")) || {tasksCompleted:2}; // change tasksCompleted to test

// Mock deals
const studentDeals = [
  {id:1,business:"Cafe Mocha",desc:"Free coffee with any snack",day:"Mon",location:"In-store",expiryMinutes:180},
  {id:2,business:"Tech Store",desc:"10% off student laptops",day:"Tue",location:"Online",expiryMinutes:240},
  {id:3,business:"BookWorld",desc:"Buy 1 Get 1 free textbook",day:"Wed",location:"In-store",expiryMinutes:120},
  {id:4,business:"CinemaX",desc:"Student tickets $5",day:"Thu",location:"In-store",expiryMinutes:360},
  {id:5,business:"GymPlus",desc:"Free 1-week trial",day:"Fri",location:"Online",expiryMinutes:300},
];

// Render deals
const container = document.getElementById("dealsContainer");
const today = new Date().getDay(); // 0=Sun, 1=Mon ...

studentDeals.forEach(deal=>{
  const card = document.createElement("div");
  card.className="deal-card";

  // Locked check: needs 3 tasks
  if(currentUser.tasksCompleted < 3){
    card.innerHTML = `
      <h3>${deal.business}</h3>
      <p>${deal.desc}</p>
      <div class="meta">
        <span>${deal.day} · ${deal.location}</span>
        <span class="badge locked">Locked</span>
      </div>
    `;
    container.appendChild(card);
  } else {
    const countdownId = "countdown"+deal.id;
    card.innerHTML = `
      <h3>${deal.business}</h3>
      <p>${deal.desc}</p>
      <div class="meta">
        <span>${deal.day} · ${deal.location}</span>
        <span class="badge active">Active Today</span>
      </div>
      <div style="margin-top:6px;font-size:.8rem;" id="${countdownId}">Expires in: --:--:--</div>
    `;
    container.appendChild(card);

    // Countdown timer
    const expiryTime = new Date().getTime() + deal.expiryMinutes*60000;
    const countdownEl = document.getElementById(countdownId);
    setInterval(()=>{
      const now = new Date().getTime();
      let diff = expiryTime - now;
      if(diff<0){countdownEl.innerText="Deal expired"; return;}
      const h = Math.floor(diff/3600000);
      const m = Math.floor((diff%3600000)/60000);
      const s = Math.floor((diff%60000)/1000);
      countdownEl.innerText=`Expires in: ${h}h ${m}m ${s}s`;
    },1000);
  }
});

// Show locked message if less than 3 tasks
if(currentUser.tasksCompleted<3){
  const lockedMsg = document.createElement("div");
  lockedMsg.className="locked-message";
  lockedMsg.innerHTML = `
    Complete 3 tasks on <strong>Learn & Earn</strong> to unlock today's deals
    <br><button onclick="location.href='learn-earn.html'">Go to Learn & Earn</button>
  `;
  container.prepend(lockedMsg);
}
</script>

</body>
</html>