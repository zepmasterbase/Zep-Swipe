<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Zep Swipe ‚Äî Learn & Earn</title>

<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600;700&family=Poppins:wght@300;400,500,600&display=swap" rel="stylesheet">

<style>
:root{
  --zep-blue:#00f0ff;
  --zep-violet:#9c4dff;
  --bg:radial-gradient(circle at 30% 10%, #050018, #00000c);
  --glass:rgba(255,255,255,.08);
  --text-light:rgba(255,255,255,.85);
}

/* RESET */
*{box-sizing:border-box;margin:0;padding:0;font-family:Poppins,sans-serif;}
body{background:var(--bg);color:#fff;min-height:100vh;}

/* HEADER */
header{
  display:flex;justify-content:space-between;align-items:center;
  padding:18px;margin:16px;border-radius:16px;
  background:radial-gradient(circle at center, rgba(0,240,255,.2), rgba(156,77,255,.2));
  backdrop-filter:blur(14px);
}
.brand{
  font-family:Orbitron;font-size:1.5rem;
  background:linear-gradient(90deg,var(--zep-blue),var(--zep-violet));
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;
}
.home-btn{
  width:50px;height:50px;border-radius:50%;border:none;background:linear-gradient(135deg,var(--zep-blue),var(--zep-violet));
  cursor:pointer;color:#050015;font-size:24px;
  display:flex;align-items:center;justify-content:center;
  box-shadow:0 0 20px var(--zep-blue),0 0 40px var(--zep-violet);
  transition:.3s;
}
.home-btn:hover{transform:scale(1.1);}

/* PROFILE SUMMARY */
.profile-container{
  display:flex;align-items:center;gap:16px;
  background:var(--glass);border-radius:16px;padding:16px;margin:16px;
  border:1px solid rgba(255,255,255,.12);
}
.profile-container img{
  width:80px;height:80px;border-radius:50%;border:2px solid rgba(255,255,255,.3);object-fit:cover;
}
.profile-details h3{margin-bottom:4px;}
.profile-details span{font-size:.85rem;color:var(--text-light);display:block;}

/* 21-DAY TASK GRID */
.tasks-container{
  display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));
  gap:12px;margin:16px;
}
.task-card{
  background:var(--glass);
  border:1px solid rgba(255,255,255,.12);
  border-radius:12px;
  padding:12px;
  display:flex;flex-direction:column;
  align-items:center;
  justify-content:center;
  cursor:pointer;
  transition:.3s;
  position:relative;
}
.task-card:hover{box-shadow:0 0 20px var(--zep-blue),0 0 40px var(--zep-violet);transform:scale(1.05);}
.task-card.completed{background:linear-gradient(135deg,var(--zep-blue),var(--zep-violet));color:#050015;}
.task-card.completed::after{
  content:"‚úÖ";position:absolute;top:6px;right:6px;font-size:1rem;
}
.task-card.locked{opacity:.4;pointer-events:none;}

/* TASK DETAIL PANEL */
#taskDetail{
  background:var(--glass);border-radius:16px;padding:16px;margin:16px;
}
#taskDetail h4{margin-bottom:8px;}
#taskDetail input[type="text"]{width:100%;padding:10px;margin:8px 0;border-radius:12px;border:none;outline:none;background:rgba(255,255,255,.05);color:#fff;}
#taskDetail button{width:100%;padding:12px;border:none;border-radius:999px;background:linear-gradient(90deg,var(--zep-blue),var(--zep-violet));color:#050015;font-family:Orbitron;cursor:pointer;transition:.3s;}
#taskDetail button:hover{transform:translateY(-2px);box-shadow:0 0 20px var(--zep-blue),0 0 40px var(--zep-violet);}

/* VERIFIED CALL-TO-ACTION */
#verifyContainer{
  margin:16px;padding:16px;border-radius:16px;background:linear-gradient(135deg,rgba(0,240,255,.1),rgba(156,77,255,.1));
  display:flex;flex-direction:column;gap:12px;align-items:center;
}
#verifyContainer button{padding:12px 16px;border:none;border-radius:999px;background:linear-gradient(90deg,var(--zep-blue),var(--zep-violet));color:#050015;font-family:Orbitron;cursor:pointer;transition:.3s;}
#verifyContainer button:hover{transform:scale(1.05);box-shadow:0 0 20px var(--zep-blue),0 0 40px var(--zep-violet);}
#verifiedBadge{color:#00ff4d;font-weight:700;font-size:1.1rem;}
</style>
</head>

<body>

<header>
  <div class="brand">Zep Swipe</div>
  <button class="home-btn" onclick="location.href='student-dashboard.html'" title="Home">üè†</button>
</header>

<!-- PROFILE SUMMARY -->
<div class="profile-container">
  <img id="profileImg" src="">
  <div class="profile-details">
    <h3 id="studentName"></h3>
    <span id="studentLevel"></span>
    <span id="tasksCompleted"></span>
    <span id="walletBalance"></span>
    <span id="verifiedBadge"></span>
  </div>
</div>

<!-- 21-DAY TASK GRID -->
<div class="tasks-container" id="tasksContainer"></div>

<!-- TASK DETAIL PANEL -->
<div id="taskDetail" style="display:none;">
  <h4 id="taskTitle"></h4>
  <p id="taskDescription"></p>
  <input type="text" id="taskInput" placeholder="Paste your submission link here">
  <button onclick="completeTask()">Complete Task</button>
</div>

<!-- VERIFIED FREELANCER PAYMENT -->
<div id="verifyContainer">
  <div id="verifyText">Subscribe $5 to become a verified freelancer and unlock the marketplace</div>
  <button onclick="payFlutterwave()">Pay $5 & Verify</button>
</div>

<script src="https://checkout.flutterwave.com/v3.js"></script>
<script>
/* ===============================
   SESSION & USER
================================*/
let users = JSON.parse(localStorage.getItem("users")) || {};
let currentUserId = localStorage.getItem("currentUserId");
if(!currentUserId || !users[currentUserId]) location.href="login.html";

let currentUser = users[currentUserId];

/* ===============================
   PROFILE DISPLAY
================================*/
const profileImg = document.getElementById("profileImg");
const studentName = document.getElementById("studentName");
const studentLevel = document.getElementById("studentLevel");
const tasksCompletedSpan = document.getElementById("tasksCompleted");
const walletBalance = document.getElementById("walletBalance");
const verifiedBadge = document.getElementById("verifiedBadge");

function updateProfileUI(){
  profileImg.src = currentUser.profileImage || "https://via.placeholder.com/80";
  studentName.innerText = currentUser.name;
  studentLevel.innerText = currentUser.level;
  tasksCompletedSpan.innerText = `Tasks Completed: ${currentUser.tasksCompleted || 0}/21`;
  walletBalance.innerText = `Wallet: ${currentUser.walletBalance || 0} ZAC`;
  verifiedBadge.innerText = currentUser.verified ? "‚úÖ Verified Freelancer" : "";
}
updateProfileUI();

/* ===============================
   TASK GRID
================================*/
const tasksContainer = document.getElementById("tasksContainer");
const taskDetail = document.getElementById("taskDetail");
const taskTitle = document.getElementById("taskTitle");
const taskDescription = document.getElementById("taskDescription");
const taskInput = document.getElementById("taskInput");

if(!currentUser.tasks) currentUser.tasks = Array(21).fill(false);
if(!currentUser.tasksCompleted) currentUser.tasksCompleted = 0;

function renderTasks(){
  tasksContainer.innerHTML = "";
  currentUser.tasks.forEach((completed,i)=>{
    const card = document.createElement("div");
    card.className = "task-card";
    if(completed) card.classList.add("completed");
    if(i > 0 && !currentUser.tasks[i-1]) card.classList.add("locked");
    card.innerHTML = `<span>Day ${i+1}</span>`;
    card.addEventListener('click',()=>openTask(i));
    tasksContainer.appendChild(card);
  });
}
renderTasks();

let currentTaskIndex = null;

function openTask(index){
  currentTaskIndex = index;
  taskDetail.style.display = "block";
  taskTitle.innerText = `Day ${index+1} Task`;
  taskDescription.innerText = "Record an intro video of yourself, sign up on www.zora.co, upload the video to your profile, copy the link, and submit it here to complete the task.";
  taskInput.value = "";
}

/* ===============================
   COMPLETE TASK
================================*/
function completeTask(){
  const link = taskInput.value.trim();
  if(!link) return alert("Please paste your submission link");
  
  currentUser.tasks[currentTaskIndex] = true;
  currentUser.tasksCompleted = currentUser.tasks.filter(t=>t).length;
  currentUser.walletBalance = (currentUser.walletBalance || 0) + 10; // Example ZAC reward
  users[currentUserId] = currentUser;
  localStorage.setItem("users", JSON.stringify(users));
  updateProfileUI();
  renderTasks();
  alert("Task completed! +10 ZAC earned");
  
  // Hide detail panel
  taskDetail.style.display = "none";
}

/* ===============================
   FLUTTERWAVE PAYMENT
================================*/
function payFlutterwave(){
  if(currentUser.tasksCompleted < 21){
    return alert("Complete all 21 days first to verify");
  }

  FlutterwaveCheckout({
    public_key: "FLWPUBK_TEST-xxxxxxxxxxxxxxxxxxxx", // replace with your Flutterwave public key
    tx_ref: "ZEP-"+Math.floor(Math.random()*1000000),
    amount: 5,
    currency: "USD",
    payment_options: "card,mobilemoney",
    customer:{
      email: currentUser.email,
      name: currentUser.name
    },
    callback: function(data){
      // Payment success
      currentUser.verified = true;
      users[currentUserId] = currentUser;
      localStorage.setItem("users", JSON.stringify(users));
      updateProfileUI();
      alert("You are now a verified freelancer!");
    },
    onclose: function() {},
    customizations:{
      title: "Zep Swipe Verification",
      description: "Verify as freelancer to unlock marketplace",
      logo: "https://zepawipe.com/logo.png"
    }
  });
}
</script>

</body>
</html>