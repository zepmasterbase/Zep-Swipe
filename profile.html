<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ZepShop — Student Profile</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600;700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
  <style>
    :root{
      --zep-blue: #00f0ff;
      --zep-violet: #9c4dff;
      --bg-dark: #050018;
      --card: rgba(255,255,255,0.04);
      --glass-border: rgba(255,255,255,0.06);
      --neon-shadow: 0 6px 30px rgba(0,240,255,0.07), inset 0 -6px 22px rgba(156,77,255,0.02);
    }
    html,body{height:100%; margin:0; font-family:Poppins,system-ui; background: radial-gradient(circle at 10% 10%, #07021b, #010007 60%); color:#e6faff}
    .container{max-width:960px; margin:28px auto; padding:18px}
    header{display:flex; align-items:center; justify-content:space-between; gap:12px; padding:14px; border-radius:14px; background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); border:1px solid var(--glass-border); box-shadow: var(--neon-shadow)}
    .brand{display:flex; gap:12px; align-items:center}
    .logo{ width:56px; height:56px; border-radius:12px; display:grid; place-items:center; font-family:Orbitron; font-weight:700; font-size:20px; background: linear-gradient(90deg,#00d7ff,#7f49ff); color:#030014; box-shadow:0 10px 30px rgba(0,240,255,0.12);}    
    .nav-actions{display:flex; gap:8px; align-items:center}
    .btn { border: none; padding:10px 14px; border-radius:12px; font-weight:700; cursor:pointer; font-family:Orbitron; }
    .btn-ghost{ background: transparent; color:#aeefff; border:1px solid rgba(174,239,255,0.06) }
    .btn-primary{ background: linear-gradient(90deg,#00f0ff,#9c4dff); color:#050014; box-shadow:0 8px 30px rgba(156,77,255,0.06) }

    .grid{display:grid; grid-template-columns:320px 1fr; gap:18px; margin-top:18px}
    .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); border-radius:12px; padding:16px; border:1px solid var(--glass-border); box-shadow:0 12px 40px rgba(0,0,0,0.4)}

    .avatar-wrap{display:grid; place-items:center; gap:12px}
    .avatar{width:160px; height:160px; border-radius:14px; background:linear-gradient(90deg,#0b0b14,#060616); display:grid; place-items:center; font-weight:800; color:#e8faff}
    .small{font-size:13px; color:#bfefff}

    label{display:block; font-size:13px; margin-bottom:6px; color:#dff9ff}
    input[type="text"], input[type="file"], textarea{width:100%; padding:10px 12px; border-radius:8px; border:1px solid rgba(255,255,255,0.04); background:transparent; color:#e6faff}
    textarea{min-height:100px}

    .field{margin-top:12px}
    .muted{font-size:13px; color:#9fefff}

    .row{display:flex; gap:8px}
    .badge{display:inline-block; padding:6px 10px; border-radius:999px; background:linear-gradient(90deg,#00f0ff,#9c4dff); color:#050014; font-weight:800}

    .id-preview{margin-top:10px; display:flex; gap:8px; align-items:center}
    .id-thumb{width:120px; height:80px; border-radius:8px; background:#07071a; display:grid; place-items:center; color:#cfefff}

    .help{font-size:13px; color:#9fefff; margin-top:8px}

    footer{margin-top:30px; text-align:center; color:#95e9ff; opacity:0.7; font-size:13px}

    @media(max-width:880px){.grid{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="brand">
        <div class="logo">Z</div>
        <div>
          <div style="font-size:14px; opacity:0.95; font-family:Orbitron">ZepShop</div>
          <div style="font-size:12px; color:#9fefff; margin-top:4px">Student Profile — Verification</div>
        </div>
      </div>

      <div class="nav-actions">
        <button id="saveBtn" class="btn btn-primary">Save Profile</button>
        <button id="dashboardBtn" class="btn btn-ghost">Go to Dashboard</button>
      </div>
    </header>

    <div class="grid">
      <div class="card">
        <div style="display:flex; flex-direction:column; align-items:center;">
          <div class="avatar-wrap">
            <div id="avatarEl" class="avatar">S</div>
            <div class="small">Profile picture will appear on your dashboard and listings</div>
            <div style="width:100%; margin-top:12px">
              <label class="small">Upload profile picture</label>
              <input id="profilePicInput" type="file" accept="image/*">
            </div>
            <div style="width:100%; margin-top:8px">
              <label class="small">Upload University ID (for verification)</label>
              <input id="idDocInput" type="file" accept="image/*,application/pdf">
            </div>

            <div class="id-preview" id="idPreview" style="display:none">
              <div class="id-thumb" id="idThumb">ID</div>
              <div style="flex:1">
                <div id="idName" style="font-weight:800">Uploaded ID</div>
                <div class="muted" id="idInfo">Click save to persist</div>
              </div>
            </div>

            <div style="margin-top:12px; width:100%">
              <button id="requestVerifyBtn" class="btn btn-primary" disabled>Request Verification</button>
              <button id="clearBtn" class="btn btn-ghost" style="margin-left:8px">Clear</button>
            </div>
          </div>
        </div>
      </div>

      <div>
        <div class="card">
          <h3 style="margin:0 0 8px">Your details</h3>
          <div class="field">
            <label>Full name</label>
            <input id="fullName" type="text" placeholder="e.g. Jane Doe">
          </div>

          <div class="field">
            <label>University</label>
            <input id="university" type="text" placeholder="e.g. University of Cape Town">
          </div>

          <div class="field">
            <label>University ID number</label>
            <input id="universityId" type="text" placeholder="e.g. 12345678">
          </div>

          <div class="field">
            <label>Short bio (optional)</label>
            <textarea id="bio" placeholder="Tell other students about your skills and availability"></textarea>
          </div>

          <div class="field" style="margin-top:14px; display:flex; align-items:center; gap:12px">
            <div>Verification status:</div>
            <div id="statusEl" class="badge">Not verified</div>
            <div class="muted" id="statusNote">Verification helps buyers trust you.</div>
          </div>

          <div class="help">All files and profile data are stored locally in your browser (localStorage) for this demo. For production, upload to a secure backend and encrypted storage.</div>
        </div>

        <div class="card" style="margin-top:12px">
          <h4 style="margin:0 0 8px">Preview (how others see you)</h4>
          <div style="display:flex; gap:12px; align-items:center">
            <div style="width:72px; height:72px; border-radius:10px; overflow:hidden; background:#07071a; display:grid; place-items:center" id="previewAvatar">S</div>
            <div>
              <div style="font-weight:800" id="previewName">Your name</div>
              <div class="muted" id="previewUni">Your university</div>
            </div>
            <div style="margin-left:auto">
              <div id="previewBadge" class="badge" style="display:none">Verified</div>
            </div>
          </div>
        </div>

      </div>
    </div>

    <footer>
      © <span id="year"></span> ZepShop — Zep Swipe. Built on Base.
    </footer>
  </div>

  <script>
    // localStorage key
    const STORAGE_KEY = 'zepProfile_v1';

    // UI refs
    const profilePicInput = document.getElementById('profilePicInput');
    const idDocInput = document.getElementById('idDocInput');
    const avatarEl = document.getElementById('avatarEl');
    const idPreview = document.getElementById('idPreview');
    const idThumb = document.getElementById('idThumb');
    const idName = document.getElementById('idName');
    const requestVerifyBtn = document.getElementById('requestVerifyBtn');
    const clearBtn = document.getElementById('clearBtn');
    const saveBtn = document.getElementById('saveBtn');
    const dashboardBtn = document.getElementById('dashboardBtn');

    const fullName = document.getElementById('fullName');
    const university = document.getElementById('university');
    const universityId = document.getElementById('universityId');
    const bio = document.getElementById('bio');

    const statusEl = document.getElementById('statusEl');
    const statusNote = document.getElementById('statusNote');

    const previewAvatar = document.getElementById('previewAvatar');
    const previewName = document.getElementById('previewName');
    const previewUni = document.getElementById('previewUni');
    const previewBadge = document.getElementById('previewBadge');

    document.getElementById('year').textContent = new Date().getFullYear();

    let state = {
      fullName: '',
      university: '',
      universityId: '',
      bio: '',
      profilePic: null, // dataURL
      idDoc: null, // dataURL or filename
      verificationRequested: false,
      verified: false,
    };

    // helpers
    const readFileAsDataURL = (file) => new Promise((res, rej) => {
      const reader = new FileReader();
      reader.onload = () => res(reader.result);
      reader.onerror = rej;
      reader.readAsDataURL(file);
    });

    function setStatus(){
      if(state.verified){ statusEl.innerText = 'Verified'; statusEl.style.background = 'linear-gradient(90deg,#00f0ff,#9c4dff)'; previewBadge.style.display='inline-block'; }
      else if(state.verificationRequested){ statusEl.innerText = 'Pending'; statusEl.style.background = 'linear-gradient(90deg,#ffd36b,#ff7a7a)'; previewBadge.style.display='none'; }
      else { statusEl.innerText = 'Not verified'; statusEl.style.background = '#4b5563'; previewBadge.style.display='none'; }
    }

    function updatePreviews(){
      previewName.innerText = state.fullName || 'Your name';
      previewUni.innerText = state.university || 'Your university';
      if(state.profilePic){
        avatarEl.style.backgroundImage = `url(${state.profilePic})`;
        avatarEl.style.backgroundSize = 'cover';
        avatarEl.textContent = '';
        previewAvatar.style.backgroundImage = `url(${state.profilePic})`;
        previewAvatar.style.backgroundSize = 'cover';
        previewAvatar.textContent = '';
      } else {
        avatarEl.style.backgroundImage = '';
        avatarEl.textContent = (state.fullName ? state.fullName.slice(0,1).toUpperCase() : 'S');
        previewAvatar.style.backgroundImage = '';
        previewAvatar.textContent = (state.fullName ? state.fullName.slice(0,1).toUpperCase() : 'S');
      }

      if(state.idDoc){
        idPreview.style.display='flex';
        if(state.idDocType && state.idDocType.startsWith('image/')){
          idThumb.style.backgroundImage = `url(${state.idDoc})`;
          idThumb.style.backgroundSize = 'cover';
          idThumb.textContent='';
        } else {
          idThumb.style.backgroundImage = '';
          idThumb.textContent = 'DOC';
        }
        idName.innerText = `ID ${state.universityId || ''}`;
        requestVerifyBtn.disabled = false;
      } else {
        idPreview.style.display='none';
        requestVerifyBtn.disabled = true;
      }

      setStatus();
    }

    // load from localStorage
    function loadProfile(){
      const raw = localStorage.getItem(STORAGE_KEY);
      if(!raw) return;
      try{
        const obj = JSON.parse(raw);
        state = { ...state, ...obj };
        // ensure fields updated
        fullName.value = state.fullName || '';
        university.value = state.university || '';
        universityId.value = state.universityId || '';
        bio.value = state.bio || '';
        updatePreviews();
      }catch(e){ console.warn('loadProfile parse err', e); }
    }

    // save to localStorage
    function saveProfile(){
      state.fullName = fullName.value.trim();
      state.university = university.value.trim();
      state.universityId = universityId.value.trim();
      state.bio = bio.value.trim();
      localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
      alert('Profile saved locally.');
      updatePreviews();
    }

    // clear
    function clearProfile(){
      if(!confirm('Clear profile data from this browser? This cannot be undone.')) return;
      localStorage.removeItem(STORAGE_KEY);
      state = { fullName:'', university:'', universityId:'', bio:'', profilePic:null, idDoc:null, verificationRequested:false, verified:false };
      fullName.value=''; university.value=''; universityId.value=''; bio.value='';
      updatePreviews();
      alert('Profile cleared.');
    }

    // handle uploads
    profilePicInput.addEventListener('change', async (e)=>{
      const f = e.target.files[0];
      if(!f) return;
      if(!f.type.startsWith('image/')) return alert('Profile picture must be an image file.');
      const data = await readFileAsDataURL(f);
      state.profilePic = data;
      saveProfile();
      updatePreviews();
    });

    idDocInput.addEventListener('change', async (e)=>{
      const f = e.target.files[0];
      if(!f) return;
      const data = await readFileAsDataURL(f);
      state.idDoc = data;
      state.idDocType = f.type;
      // mark that verification needs to be requested again when ID changes
      state.verificationRequested = false;
      state.verified = false;
      saveProfile();
      updatePreviews();
    });

    requestVerifyBtn.addEventListener('click', ()=>{
      if(!state.idDoc || !university.value || !universityId.value) return alert('Please provide university name, ID number, and upload your ID document first.');
      state.verificationRequested = true;
      state.verified = false; // reset verified
      saveProfile();
      alert('Verification requested. In a production app this would notify an admin to manually verify your ID. For demo you can click "Mark verified" in the console or call the simulate function.');
      updatePreviews();
    });

    // small helper to simulate admin verification (for demo)
    window.simulateMarkVerified = function(){
      state.verified = true; state.verificationRequested = false; saveProfile(); updatePreviews(); alert('Profile marked as verified (demo).'); }

    saveBtn.addEventListener('click', saveProfile);
    clearBtn.addEventListener('click', clearProfile);
    dashboardBtn.addEventListener('click', ()=>{ saveProfile(); location.href='student-dashboard.html'; });

    // update previews when typing
    [fullName, university, universityId, bio].forEach(el=> el.addEventListener('input', ()=>{ state.fullName = fullName.value; state.university = university.value; state.universityId = universityId.value; state.bio = bio.value; updatePreviews(); }));

    // initial load
    loadProfile();
    updatePreviews();
  </script>
</body>
</html>
