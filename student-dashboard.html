<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Zep Swipe â€” Student Dashboard</title>

<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600,700&family=Poppins:wght@300;400,500,600&display=swap" rel="stylesheet">

<style>
:root{
  --zep-blue:#00f0ff;
  --zep-violet:#9c4dff;
  --bg:radial-gradient(circle at 30% 10%, #050018, #00000c);
  --glass:rgba(255,255,255,.08);
  --text-light:rgba(255,255,255,.85);
}

/* RESET */
*{box-sizing:border-box;margin:0;padding:0;font-family:Poppins,sans-serif;}
body{background:var(--bg);color:#fff;min-height:100vh;}

/* HEADER */
header{
  display:flex;justify-content:space-between;align-items:center;
  padding:18px;margin:16px;border-radius:16px;
  background:radial-gradient(circle at center, rgba(0,240,255,.2), rgba(156,77,255,.2));
  backdrop-filter:blur(14px);
}
.brand{
  font-family:Orbitron;font-size:1.5rem;
  background:linear-gradient(90deg,var(--zep-blue),var(--zep-violet));
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;
}
.logout-btn{
  background:rgba(255,255,255,.1);border:none;border-radius:50%;
  width:38px;height:38px;color:#fff;cursor:pointer;
}

/* DASHBOARD LAYOUT */
.dashboard{
  padding:16px;display:flex;flex-direction:column;
  gap:22px;max-width:1200px;margin:auto;
}
.section{
  background:var(--glass);
  border-radius:16px;
  padding:16px;
  border:1px solid rgba(255,255,255,.12);
}
.section h3{font-family:Orbitron;margin-bottom:12px;}

/* PROFILE */
.profile-summary{
  display:flex;align-items:center;gap:16px;
}
.profile-summary img{
  width:80px;height:80px;border-radius:50%;
  border:2px solid rgba(255,255,255,.3);
}
.profile-summary span{font-size:.85rem;color:var(--text-light);}
#verifiedBadge{
  display:inline-block;
  margin-left:8px;
  padding:2px 8px;
  background:linear-gradient(90deg,#00ff9d,#00f0ff);
  color:#050015;
  border-radius:12px;
  font-size:0.75rem;
  font-weight:600;
}

/* GRAPH */
.graph-box{
  position:relative;height:180px;border-radius:14px;
  background:linear-gradient(135deg,rgba(0,240,255,.08),rgba(156,77,255,.08));
  overflow:hidden;cursor:pointer;
}
.graph-placeholder{
  position:absolute;inset:0;
  display:flex;align-items:center;justify-content:center;
  font-family:Orbitron;
  animation:pulse 2s infinite;
}
@keyframes pulse{
  0%{opacity:.6}50%{opacity:1}100%{opacity:.6}
}
.bars{display:flex;align-items:flex-end;height:100%;gap:8px;padding:16px;}
.bar{
  flex:1;
  background:linear-gradient(180deg,var(--zep-blue),var(--zep-violet));
  border-radius:8px 8px 0 0;
  animation:grow .8s ease forwards;
}
@keyframes grow{from{height:0}}

/* ANALYTICS */
.analytics{display:none;margin-top:12px;font-size:.85rem;}
.analytics.active{display:block}

/* JOBS */
.jobs-list{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(240px,1fr));
  gap:12px;
}
.job{
  background:rgba(255,255,255,.05);
  border-radius:12px;
  padding:12px;
  position:relative;
}
.job.locked{filter:blur(4px);pointer-events:none;}
.verify-overlay{
  position:absolute;inset:0;
  background:rgba(0,0,0,.75);
  display:flex;align-items:center;justify-content:center;
  text-align:center;border-radius:12px;
}
.verify-overlay button{
  margin-top:10px;padding:8px 14px;
  border:none;border-radius:999px;
  background:linear-gradient(90deg,var(--zep-blue),var(--zep-violet));
  cursor:pointer;
}

/* ACTIONS */
.actions{
  display:grid;grid-template-columns:repeat(3,1fr);gap:10px;
}
.actions button{
  border:none;border-radius:999px;padding:12px;
  font-family:Orbitron;
  background:linear-gradient(90deg,var(--zep-blue),var(--zep-violet));
  cursor:pointer;
}
@media(max-width:480px){.actions{grid-template-columns:1fr}}

/* FLOATING ZEP AI BUTTON */
#zepAIButton{
  position:fixed;
  bottom:20px;
  right:20px;
  background:linear-gradient(135deg,var(--zep-blue),var(--zep-violet));
  border:none;
  border-radius:50%;
  width:60px;
  height:60px;
  cursor:pointer;
  font-size:24px;
  display:flex;
  justify-content:center;
  align-items:center;
  color:#050015;
  box-shadow:0 0 20px var(--zep-blue),0 0 40px var(--zep-violet);
  animation:orbPulse 2s infinite;
  z-index:1000;
}
@keyframes orbPulse{
  0%{transform:scale(1);}
  50%{transform:scale(1.1);}
  100%{transform:scale(1);}
}
</style>
</head>

<body>

<header>
  <div class="brand">Zep Swipe</div>
  <button class="logout-btn" onclick="logout()">âŽ‹</button>
</header>

<div class="dashboard">

  <!-- PROFILE -->
  <div class="section profile-summary">
    <img id="profileImg">
    <div>
      <h3 id="studentName"></h3>
      <span id="studentLevel"></span><br>
      <span id="completionText"></span><br>
      <span id="walletBalance"></span>
    </div>
    <span id="verifiedBadge" style="display:none;">Verified âœ…</span>
  </div>

  <!-- WEEKLY GRAPH -->
  <div class="section">
    <h3>Weekly Earnings</h3>
    <div class="graph-box" onclick="toggleAnalytics()">
      <div id="graphPlaceholder" class="graph-placeholder">Start Learning to See Earnings ðŸ“ˆ</div>
      <div id="bars" class="bars"></div>
    </div>
    <div id="analytics" class="analytics"></div>
  </div>

  <!-- EARNINGS SUMMARY -->
  <div class="section earnings">
    <div>
      <h4>Weekly</h4>
      <span id="weeklyUSD">$0</span><br>
      <span id="weeklyZAC">0 ZAC</span>
    </div>
    <div>
      <h4>Monthly</h4>
      <span id="monthlyUSD">$0</span><br>
      <span id="monthlyZAC">0 ZAC</span>
    </div>
  </div>

  <!-- JOBS -->
  <div class="section">
    <h3>Live Jobs</h3>
    <div class="jobs-list" id="jobsList"></div>
  </div>

  <!-- ACTIONS -->
  <div class="section actions">
    <button onclick="location.href='learn-earn.html'">Tasks</button>
    <button onclick="location.href='swipe-merchants.html'">Jobs</button>
    <button onclick="location.href='wallet.html'">Wallet</button>
    <button onclick="location.href='profile.html'">Profile</button>
    <button onclick="location.href='deals.html'">Deals Day</button>
  </div>

</div>

<!-- FLOATING ZEP AI BUTTON -->
<button id="zepAIButton" title="Zep AI Mentor" onclick="location.href='zep-ai.html'">ðŸ¤–</button>

<script>
/* =======================
   USER SESSION & LOGOUT
======================= */
let users = JSON.parse(localStorage.getItem("users")) || [];
let currentUserId = localStorage.getItem("currentUserId");

if(!currentUserId){
  location.href="login.html";
}

let currentUser = users.find(u=>u.id===currentUserId);

function logout(){
  localStorage.removeItem("currentUserId");
  location.href="login.html";
}

/* =======================
   PROFILE
======================= */
const profileImg = document.getElementById("profileImg");
const studentName = document.getElementById("studentName");
const studentLevel = document.getElementById("studentLevel");
const completionText = document.getElementById("completionText");
const walletBalance = document.getElementById("walletBalance");
const verifiedBadge = document.getElementById("verifiedBadge");

function renderProfile(){
  profileImg.src = currentUser.profileImage || "https://via.placeholder.com/80";
  studentName.innerText = currentUser.name;
  studentLevel.innerText = currentUser.level;
  completionText.innerText = `Profile Completion: ${currentUser.profileCompletion || 0}%`;
  verifiedBadge.style.display = currentUser.verified ? 'inline-block' : 'none';
}

renderProfile();

/* =======================
   WALLET
======================= */
function updateWallet(){
  const zac = currentUser.walletBalance || 0;
  const usd = (zac*0.014).toFixed(2);
  walletBalance.innerText = `Wallet: ${zac} ZAC (~$${usd})`;
  document.getElementById("weeklyZAC").innerText = zac;
  document.getElementById("weeklyUSD").innerText = `$${usd}`;
  document.getElementById("monthlyZAC").innerText = zac;
  document.getElementById("monthlyUSD").innerText = `$${usd}`;
}
updateWallet();

/* =======================
   GRAPH
======================= */
const graphPlaceholder = document.getElementById("graphPlaceholder");
const bars = document.getElementById("bars");
const analytics = document.getElementById("analytics");

const earnings = currentUser.earningsHistory || [];
if(earnings.length){
  graphPlaceholder.style.display="none";
  earnings.slice(-7).forEach(v=>{
    const b=document.createElement("div");
    b.className="bar";
    b.style.height=(v/100)*100+"%";
    bars.appendChild(b);
  });
  analytics.innerHTML=`Total streak days: ${currentUser.tasksCompleted || 0}<br>Total ZAC earned: ${currentUser.walletBalance || 0}`;
}

function toggleAnalytics(){
  analytics.classList.toggle("active");
}

/* =======================
   JOBS
======================= */
const jobs = JSON.parse(localStorage.getItem("swipeJobs")) || [];
const jobsList = document.getElementById("jobsList");
jobsList.innerHTML = '';
jobs.forEach(j=>{
  const d=document.createElement("div");
  d.className="job";
  if(!currentUser.verified) d.classList.add("locked");
  d.innerHTML=`<h4>${j.title}</h4><span>${j.amountUSD} USD</span>`;
  if(!currentUser.verified){
    d.innerHTML+=`<div class="verify-overlay">
      <div>
        <strong>Verify Account</strong><br>
        Unlock paid jobs
        <br><button onclick="location.href='profile.html'">Verify</button>
      </div>
    </div>`;
  }
  jobsList.appendChild(d);
});

/* =======================
   UPDATE USER DATA IN REAL TIME
======================= */
function updateUser(newData){
  currentUser = {...currentUser, ...newData};
  const idx = users.findIndex(u=>u.id===currentUser.id);
  if(idx>-1) users[idx]=currentUser;
  localStorage.setItem("users",JSON.stringify(users));
  renderProfile();
  updateWallet();
  // Refresh jobs overlay if verified changes
  jobsList.innerHTML='';
  jobs.forEach(j=>{
    const d=document.createElement("div");
    d.className="job";
    if(!currentUser.verified) d.classList.add("locked");
    d.innerHTML=`<h4>${j.title}</h4><span>${j.amountUSD} USD</span>`;
    if(!currentUser.verified){
      d.innerHTML+=`<div class="verify-overlay">
        <div>
          <strong>Verify Account</strong><br>
          Unlock paid jobs
          <br><button onclick="location.href='profile.html'">Verify</button>
        </div>
      </div>`;
    }
    jobsList.appendChild(d);
  });
}

// Example: whenever learn-earn sets verified:
// updateUser({verified:true});

</script>
</body>
</html>