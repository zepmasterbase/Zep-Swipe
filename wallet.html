<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Zep Swipe — Wallet</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600;700&family=Poppins&display=swap" rel="stylesheet">
<style>
:root{
  --zep-blue:#00f0ff;
  --zep-violet:#9c4dff;
  --green:#00ff94;
  --bg:radial-gradient(circle at 30% 10%, #050018, #00000c);
  --glass:rgba(255,255,255,.08);
  --text-light:rgba(255,255,255,.85);
}

/* RESET */
*{box-sizing:border-box;margin:0;padding:0;font-family:Poppins,sans-serif;}
body{background:var(--bg);color:#fff;min-height:100vh;padding:20px;}

/* HEADER */
header{
  display:flex;justify-content:space-between;align-items:center;
  padding:18px;margin-bottom:20px;border-radius:16px;
  background:rgba(0,0,0,.55);
  box-shadow:0 0 30px rgba(0,240,255,.25);
}
header .brand{
  display:flex;align-items:center;gap:12px;
  font-family:Orbitron;font-size:1.5rem;
  background:linear-gradient(90deg,var(--zep-blue),var(--zep-violet));
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;
}
header .brand img{
  height:40px;border-radius:8px;
}
.logout-btn{
  background:rgba(255,255,255,.1);border:none;border-radius:50%;
  width:38px;height:38px;color:#fff;cursor:pointer;
}

/* WALLET CARD */
.wallet-card{
  background:var(--glass);padding:22px;border-radius:20px;
  border:1px solid rgba(255,255,255,.12);margin-bottom:18px;
  box-shadow:0 0 28px rgba(156,77,255,.15);
}
.wallet-card h2{
  font-family:Orbitron;font-size:1.2rem;margin-bottom:12px;color:var(--zep-blue);
}
.wallet-info{
  display:flex;flex-direction:column;gap:8px;margin-bottom:12px;
}
.wallet-info span{font-size:.95rem;}
.cta-btn{
  width:100%;padding:14px;border:none;border-radius:999px;
  background:linear-gradient(90deg,var(--zep-blue),var(--zep-violet));
  color:#050015;font-family:Orbitron;cursor:pointer;
  font-size:1rem;box-shadow:0 0 35px rgba(0,240,255,.45);
  transition:.3s;margin-top:10px;
}
.cta-btn:hover{transform:translateY(-2px);}

/* INVOICE LIST */
.invoice-list{
  display:flex;flex-direction:column;gap:12px;margin-top:12px;
}
.invoice-item{
  background:rgba(255,255,255,.05);padding:14px;border-radius:12px;
  display:flex;justify-content:space-between;align-items:center;
  cursor:pointer;transition:.2s;box-shadow:0 0 15px rgba(0,240,255,.15);
}
.invoice-item:hover{transform:scale(1.02);box-shadow:0 0 25px rgba(0,240,255,.3);}
.invoice-item .status{
  padding:4px 10px;border-radius:999px;font-size:.8rem;font-family:Orbitron;
}
.status-Pending{background:rgba(255,165,0,.3);color:#ffa500;}
.status-Work\ Submitted{background:rgba(0,150,255,.3);color:#00aaff;}
.status-Released{background:rgba(0,255,148,.3);color:#00ff94;}

/* PROFILE SUMMARY */
.profile-summary{
  display:flex;align-items:center;gap:16px;margin-bottom:16px;
}
.profile-summary img{
  width:80px;height:80px;border-radius:50%;border:2px solid rgba(255,255,255,.3);
}
.profile-summary div span{display:block;font-size:.85rem;color:var(--text-light);}
</style>
</head>
<body>

<header>
  <div class="brand">
    <img src="https://payhip.com/cdn-cgi/image/format=auto/https://pe56d.s3.amazonaws.com/o_1jfnua21qtu1vi2pfom33p641h.png" alt="Zep Swipe Logo">
    Zep Swipe
  </div>
  <button class="logout-btn" onclick="logout()">⎋</button>
</header>

<!-- Profile Summary -->
<div class="wallet-card profile-summary">
  <img id="profileImg" src="https://via.placeholder.com/80">
  <div>
    <h3 id="studentName">-</h3>
    <span id="studentLevel">-</span>
    <span id="walletBalance">Wallet: 0 ZAC (~$0)</span>
  </div>
</div>

<!-- Wallet Info -->
<div class="wallet-card">
  <h2>Your Wallet</h2>
  <div class="wallet-info">
    <span id="weeklyZAC">Weekly ZAC: 0</span>
    <span id="weeklyUSD">Weekly USD: $0</span>
    <span id="monthlyZAC">Monthly ZAC: 0</span>
    <span id="monthlyUSD">Monthly USD: $0</span>
  </div>
  <button class="cta-btn" onclick="location.href='create-invoice.html'">Create Invoice</button>
</div>

<!-- Invoice List -->
<div class="wallet-card">
  <h2>Invoices</h2>
  <div class="invoice-list" id="invoiceList"></div>
</div>

<script>
// User session
let users = JSON.parse(localStorage.getItem("users")) || {};
let currentUserId = localStorage.getItem("currentUserId");
if(!currentUserId || !users[currentUserId]) location.href="login.html";
let currentUser = users[currentUserId];

function logout(){
  localStorage.removeItem("currentUserId");
  location.href="login.html";
}

// Profile info
document.getElementById("studentName").innerText = currentUser.name;
document.getElementById("studentLevel").innerText = currentUser.level;
document.getElementById("profileImg").src = currentUser.profileImage || "https://via.placeholder.com/80";

// Wallet info
function updateWallet(){
  const zac = currentUser.walletBalance || 0;
  const usd = (zac*0.014).toFixed(2);
  document.getElementById("walletBalance").innerText = `Wallet: ${zac} ZAC (~$${usd})`;
  document.getElementById("weeklyZAC").innerText = `Weekly ZAC: ${zac}`;
  document.getElementById("weeklyUSD").innerText = `Weekly USD: $${usd}`;
  document.getElementById("monthlyZAC").innerText = `Monthly ZAC: ${zac}`;
  document.getElementById("monthlyUSD").innerText = `Monthly USD: $${usd}`;
}
updateWallet();

// Invoice list
let invoices = JSON.parse(localStorage.getItem("invoices")) || {};
const invoiceListEl = document.getElementById("invoiceList");

function renderInvoices(){
  invoiceListEl.innerHTML="";
  Object.values(invoices).forEach(inv=>{
    if(inv.studentId !== currentUserId) return;
    const item = document.createElement("div");
    item.className="invoice-item";
    item.innerHTML=`<span>${inv.serviceTitle} - ${inv.clientName}</span>
                    <span class="status status-${inv.status.replace(/\s/g,'')}">${inv.status}</span>`;
    item.addEventListener('click',()=>{window.location.href=`invoice.html?invoice_id=${inv.id}`});
    invoiceListEl.appendChild(item);
  });
}
renderInvoices();

// Listen for real-time invoice updates
window.addEventListener('invoiceUpdated',(e)=>{
  if(e.detail.studentId===currentUserId){
    invoices[e.detail.id] = e.detail;
    localStorage.setItem("invoices", JSON.stringify(invoices));
    updateWallet();
    renderInvoices();
  }
});
</script>
</body>
</html>