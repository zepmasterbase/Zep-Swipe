<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Zep Swipe — Wallet</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600;700&family=Poppins:wght@300,400,500,600&display=swap" rel="stylesheet">
<style>
:root{
  --zep-blue:#00f0ff;
  --zep-violet:#9c4dff;
  --bg:radial-gradient(circle at 30% 10%, #050018, #00000c);
  --glass:rgba(255,255,255,0.08);
  --text-light:rgba(255,255,255,0.85);
}
*{box-sizing:border-box;margin:0;padding:0;font-family:Poppins,sans-serif;}
body{background:var(--bg);color:#fff;min-height:100vh;}
header{
  display:flex;justify-content:space-between;align-items:center;
  padding:18px;margin:16px;border-radius:16px;
  background:radial-gradient(circle at center, rgba(0,240,255,.2), rgba(156,77,255,.2));
  backdrop-filter:blur(14px);
}
.brand{
  font-family:Orbitron;font-size:1.5rem;
  background:linear-gradient(90deg,var(--zep-blue),var(--zep-violet));
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;
}
.logout-btn{
  background:rgba(255,255,255,.1);border:none;border-radius:50%;
  width:38px;height:38px;color:#fff;cursor:pointer;
}
.logout-btn:hover{
  background:rgba(0,240,255,.25);
}

.dashboard{padding:16px;display:flex;flex-direction:column;gap:22px;max-width:1200px;margin:auto;}

.section{
  background:var(--glass);
  border-radius:16px;
  padding:16px;
  border:1px solid rgba(255,255,255,.12);
}
.section h3{font-family:Orbitron;margin-bottom:12px;}

.wallet-summary{
  display:flex;flex-direction:column;gap:8px;font-size:1.1rem;
}
.wallet-summary span{font-weight:600;}

.withdraw-section{
  display:flex;flex-direction:column;gap:12px;margin-top:12px;
}
.withdraw-section input, .withdraw-section select{
  padding:10px;border-radius:12px;border:none;outline:none;width:100%;
  background:rgba(255,255,255,0.1);color:#fff;
}
.withdraw-section button{
  padding:12px;border:none;border-radius:999px;
  background:linear-gradient(90deg,var(--zep-blue),var(--zep-violet));
  font-family:Orbitron;cursor:pointer;transition:.3s;
}
.withdraw-section button:hover{transform:translateY(-2px) scale(1.02);box-shadow:0 0 15px var(--zep-blue),0 0 30px var(--zep-violet);}

/* Responsive */
@media(max-width:480px){
  .withdraw-section input{font-size:0.9rem;}
}
</style>
</head>
<body>

<header>
  <div class="brand">Zep Swipe</div>
  <button class="logout-btn" onclick="logout()">⎋</button>
</header>

<div class="dashboard">

  <!-- Wallet Balances -->
  <div class="section wallet-summary">
    <h3>Wallet Balances</h3>
    <span id="walletZAC">0 ZAC</span>
    <span id="walletUSD">~$0.00 USD</span>
  </div>

  <!-- ZAC Withdrawal (Locked) -->
  <div class="section withdraw-section">
    <h3>Withdraw ZAC (Locked)</h3>
    <p>You cannot withdraw ZAC yet. Complete tasks to unlock USD withdrawal.</p>
    <button disabled>Withdraw ZAC</button>
  </div>

  <!-- USD Withdrawal -->
  <div class="section withdraw-section">
    <h3>Withdraw USD</h3>
    <label for="withdrawMethod">Select Withdrawal Method:</label>
    <select id="withdrawMethod">
      <option value="momo">MTN Mobile Money</option>
      <option value="bank">Bank Transfer</option>
    </select>

    <input type="text" id="fullName" placeholder="Full Name">
    <input type="email" id="email" placeholder="Email">
    <input type="text" id="phone" placeholder="Phone Number (for Momo)">
    <input type="text" id="bankName" placeholder="Bank Name (if Bank)">
    <input type="text" id="accountNumber" placeholder="Account Number (if Bank)">
    <input type="text" id="branchCode" placeholder="Branch Code (if Bank)">
    <input type="number" id="usdAmount" placeholder="Amount in USD">

    <button onclick="requestUSDWithdrawal()">Request Withdrawal</button>
  </div>

</div>

<script src="https://checkout.flutterwave.com/v3.js"></script>
<script>
// Load current user
let currentUser = JSON.parse(localStorage.getItem("currentUser"));
if(!currentUser) location.href="login.html";

// Logout
function logout(){
  localStorage.removeItem("currentUser");
  location.href="login.html";
}

// Wallet update
function updateWallet(){
  const zac = currentUser.walletBalance || 0;
  const usd = (zac * 0.014).toFixed(2); // 1 ZAC = $0.014
  document.getElementById("walletZAC").innerText = `${zac} ZAC`;
  document.getElementById("walletUSD").innerText = `~$${usd} USD`;
}
updateWallet();

// USD Withdrawal Request
function requestUSDWithdrawal(){
  const method = document.getElementById("withdrawMethod").value;
  const fullName = document.getElementById("fullName").value.trim();
  const email = document.getElementById("email").value.trim();
  const phone = document.getElementById("phone").value.trim();
  const bankName = document.getElementById("bankName").value.trim();
  const accountNumber = document.getElementById("accountNumber").value.trim();
  const branchCode = document.getElementById("branchCode").value.trim();
  const usdAmount = parseFloat(document.getElementById("usdAmount").value);

  if(!fullName || !email || !usdAmount || usdAmount <=0){
    alert("Please fill all required fields correctly");
    return;
  }
  if(method === "momo" && !phone){
    alert("Please enter phone number for MTN Momo");
    return;
  }
  if(method === "bank" && (!bankName || !accountNumber || !branchCode)){
    alert("Please fill all bank details");
    return;
  }
  if(usdAmount > (currentUser.walletBalance*0.014)){
    alert("Insufficient balance");
    return;
  }

  // Prepare Flutterwave withdrawal payload (example)
  const payload = {
    tx_ref: "USD-WITHDRAW-"+Date.now(),
    amount: usdAmount,
    currency: "USD",
    payment_method: method,
    customer: {
      name: fullName,
      email: email,
      phone_number: phone || "N/A"
    },
    meta: {
      bank_name: bankName,
      account_number: accountNumber,
      branch_code: branchCode,
      student_id: currentUser.id || "12345"
    }
  };
  console.log("USD Withdrawal Request:", payload);
  alert("Withdrawal request sent! Our team will process it shortly.");

  // Optional: Deduct balance locally
  currentUser.walletBalance -= usdAmount / 0.014;
  localStorage.setItem("currentUser", JSON.stringify(currentUser));
  updateWallet();
}

</script>
</body>
</html>